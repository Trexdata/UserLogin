function isLoggedIn(e,n,s){return e.isAuthenticated()?s():void n.redirect("/")}module.exports=function(e,n){e.get("/",function(e,n){n.render("index.ejs")}),e.get("/login",function(e,n){n.render("login.ejs",{message:e.flash("loginMessage")})}),e.post("/login",function(e,s,i){n.authenticate("local",function(e,n,t){return e?i(e):s.send(n?{success:!0,message:"authentication succeeded"}:{success:!1,message:"authentication failed"})})(e,s,i)}),e.get("/signup",function(e,n){n.render("signup.ejs",{message:e.flash("signupMessage")})}),e.post("/signup",n.authenticate("local-signup",{successRedirect:"/profile",failureRedirect:"/signup",failureFlash:!0})),e.get("/profile",isLoggedIn,function(e,n){n.render("profile.ejs",{user:e.user})}),e.get("/logout",function(e,n){e.logout(),n.redirect("/")})};